<mat-card class="channel-wrapper">
  <mat-card-header>
    <div class="channel-infos" *ngIf="currentChannel">
      <div># {{ currentChannel.title }} </div>
      <div class="header-right-container">
        <ng-container *ngFor="let participant of channelParticipants">
          <img src="{{participant.participantImage}}">
        </ng-container>
        <div class="participant-counter">{{channelParticipantsCounter}} Teilnehmer</div>
      </div>
    </div>
  </mat-card-header>
  <div class="chat-history">

    <!--ChannelThreadComponents rendern (immer nur erste Nachricht des jeweiligen Threads anzeigen): 
        Wenn Klick auf einen Thread, dann wird dieser rechts geÃ¶ffnet mit dem kompletten Chatverlauf ( FullThreadComponent )
      -->
    <div *ngFor="let thread of channelThreads">
      <app-channel-thread [thread]="thread"></app-channel-thread>
    </div>

  </div>
  <!-- <form [formGroup]="channelThreadMessage" class="text-box" (ngSubmit)="sendMessage()"> -->
    <form [formGroup]="channelThreadMessage" class="text-box">
    <!-- <div class="add-file-img-box" contenteditable="true" #threadMessageBox [innerHTML]="channelThreadMessage.value.channelMessage"></div> -->
    <div #imgBox class="add-file-img-box"></div>
    <textarea #threadMessageBox formControlName="channelMessage" *ngIf="currentChannel"
      placeholder="Nachricht an #{{currentChannel.title}}"></textarea>
    <div class="interactiv-btn-box">
      <div class="interactive-btns">


        <div class="add-file">
          <img class="not-hover-icon" src="../../../assets/img/add.png" alt="">        
          <button class="hover-icon" mat-button [matMenuTriggerFor]="addFile">
            <img src="../../../assets/img/add_hover.png" alt="">
          </button>
          <mat-menu #addFile="matMenu" class="mat-menu">
            <div class="input-file-container">
              <input type="file" #fileInput (change)="handleFileInput($event)">
            </div>
         </mat-menu>
        </div>


        <div class="border-line"></div>
        <app-emoji-mart></app-emoji-mart>
        

        <div class="address-message-to-user">
          <img class="not-hover-icon" src="../../../assets/img/ping-user.png" alt="">
          <button class="hover-icon" mat-button [matMenuTriggerFor]="pingUser">
            <img src="../../../assets/img/ping-user-hover.png" alt="">
          </button>
          <mat-menu #pingUser="matMenu" class="address-message-to-user-menu">
            <mat-form-field class="example-full-width" (click)="$event.stopPropagation()">
              <mat-label>User</mat-label>
              <input type="text" placeholder="Pick one" aria-label="User" matInput [formControl]="pingUserControl"
                [matAutocomplete]="auto">
              <mat-autocomplete #auto="matAutocomplete">
                <mat-option *ngFor="let user of filteredUsers | async" [value]="user.name"
                  (click)="addUserToMessage(user)">
                  &#64;{{ user.name }}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>
          </mat-menu>
        </div>
      </div>


      <div class="send-message">
        <button class="not-hover-icon">
          <img src="../../../assets/img/send-message.png" alt="">
        </button>
        <button type="submit" class="hover-icon" (click)="sendMessage(); removeChatInput()">
          <img src="../../../assets/img/send-message-hover.png" alt="">
        </button>

      </div>
    </div>
  </form>
</mat-card>